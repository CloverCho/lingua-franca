target C {
    logging: info
};

main reactor TimersHistory {
    timer next(1sec, 1sec);
    timer Tbase(250msec, 250msec);
        
    preamble {=
    	#include <stdio.h>
    =}
        
	reaction(startup) {=
        printf("Starting in mode One\n");
    =}
    
    reaction(Tbase) {=
        printf("Tbase\n");
    =}
    
    initial mode One {
        timer T1(500msec, 500msec)
        
        reaction(T1) {=
            printf("T1\n");
        =}
    	
		reaction(next) -> Two history {=
            printf("Transitioning to mode Two (history)\n");
            SET_MODE(Two);
		=}
    }
    mode Two {
        timer T2(0msec, 500msec)
        
        reaction(T2) {=
            printf("T2\n");
        =}
    	
		reaction(next) -> One history {=
            printf("Transitioning to mode Three (history)\n");
            SET_MODE(One);
		=}
    }
    
    reaction(Tbase) {=
        printf("---\n");
    =}
}