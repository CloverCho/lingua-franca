// This tests a reactor that contains another reactor and also
// has its own reaction that routes inputs to the contained reactor.
target C(
	compile = "cc SendingInsideC.c pqueue.c reactor.c -o SendingInsideC",
	run = "./SendingInsideC -fast -stop 10 sec"
);
reactor Printer {
	input x:int;
	state count:int(1);
	reaction(x) {=
		printf("Inside reactor received: %d\n", x);
		if (x != self->count) {
			printf("FAILURE: Expected %d.\n", self->count);
			exit(1);
		}
		self->count++;
	=}
}
reactor Main {
	state count:int(0);
	timer t(0, 1 sec);
	p = new Printer();
	reaction(t) -> p.x {=
		(self->count)++;
		set(p.x, self->count);
	=}
}