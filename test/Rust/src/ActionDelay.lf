// Test logical action with delay.
target Rust;

main reactor ActionDelay {
    logical action act0;
    logical action act1(100 msec);
    state count:u32(0);

    reaction(startup) -> act0, act1 {=
        ctx.schedule(act0, After(Duration::from_millis(100)));
        ctx.schedule(act1, After(Duration::from_millis(40)));
    =}

    reaction(act0) {=
        ctx.assert_tag_eq(Duration::from_millis(100), 0);
        self.count += 1;
    =}

    reaction(act1) {=
        ctx.assert_tag_eq(Duration::from_millis(140), 0);
        self.count += 1;
    =}

    reaction(shutdown) {=
        assert_eq!(2, self.count);
        println!("SUCCESS")
    =}

}
