// Test logical action with delay.
target Rust {
    cargo-features: ["test-program"],
};

main reactor ActionDelay {
    logical action act0;
    logical action act1(100 msec);
    state count: u32(0);

    reaction(startup) -> act0, act1 {=
        ctx.schedule(act0, AfterMillis(100));
        ctx.schedule(act1, AfterMillis(40));
    =}

    reaction(act0) {=
        ctx.assert_tag_eq(Milli(100));
        self.count += 1;
    =}

    reaction(act1) {=
        ctx.assert_tag_eq(Milli(140));
        self.count += 1;
    =}

    reaction(shutdown) {=
        assert_eq!(2, self.count);
        println!("SUCCESS")
    =}

}
