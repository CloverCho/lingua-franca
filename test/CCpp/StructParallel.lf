// Source allocates an array dynamically and then sends it to two reactors,
// each of which want to modify it.
// NOTE: Ideally, only one copy would be made, but this requires
// modifying the precedence graph between reactions.
target CCpp;
import StructScale.lf;

main reactor ArrayParallel {
    s = new StructPrint();
    c1 = new Scale();
    c2 = new Scale(scale = 3);
    p1 = new Print(expected = 84);
    p2 = new Print(expected = 126);
    s.out -> c1.in;
    s.out -> c2.in;
    c1.out -> p1.in;
    c2.out -> p2.in;
}